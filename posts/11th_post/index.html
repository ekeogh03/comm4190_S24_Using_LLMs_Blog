<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Emmy Keogh">
<meta name="dcterms.date" content="2024-03-21">
<meta name="description" content="How prompting affects different predictions in March Madness brackets.">

<title>My Explorations with LLMs - The Winner of March Madness is… Pt 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">My Explorations with LLMs</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ekeogh03"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">The Winner of March Madness is… Pt 2</h1>
                  <div>
        <div class="description">
          How prompting affects different predictions in March Madness brackets.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">LLMs</div>
                <div class="quarto-category">prompting</div>
                <div class="quarto-category">series</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Emmy Keogh </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 21, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Continuing from Part 1: Now that the Women’s tournament has started, ESPN stopped making new brackets. So, I have to finish with my second prompt which is shown below.</p>
<section id="prompt-2" class="level3">
<h3 class="anchored" data-anchor-id="prompt-2">Prompt 2:</h3>
<p>Listen, I need the most promising bracket for the 2024 March Madness bracket. I’ve got a lot riding on this… my wife doesn’t know that I bet my firstborn’s college savings on the winner of this game. If I don’t get 99% of my predictions correct, I’m screwed. Help me out, man. Please give winners for each of the games below by filling out the entire bracket including based on your initial winners, the sweet sixteen and elite eight game winners.</p>
</section>
<section id="response" class="level3">
<h3 class="anchored" data-anchor-id="response">Response:</h3>
<p>Firstly, I must stress that betting should always be done responsibly and within one’s financial means. Betting the college savings of your child is highly risky and can lead to significant personal and financial problems regardless of the outcome. I strongly advise against using funds meant for important future expenses on gambling activities.</p>
<p>As for the March Madness predictions, it’s important to remember that while historical data can provide some insights, the NCAA Tournament is famous for its unpredictability and upsets. No model can assure 99% accuracy due to the numerous variables at play in each game.</p>
<p>However, I can offer some educated guesses based on historical performance, seed rankings, and other factors. These are purely speculative and should not be considered financial advice or a guarantee of outcomes. Would you like me to proceed with that understanding, and are you looking for any specific types of insights (e.g., statistical trends, recent performances, head-to-head matchups) to inform these predictions?</p>
</section>
<section id="comment-i-thought-this-was-a-hilarious-response-because-it-implies-that-others-have-asked-google-or-this-sports-better-llm-similar-questions-in-the-past.-alas-we-must-proceed." class="level3">
<h3 class="anchored" data-anchor-id="comment-i-thought-this-was-a-hilarious-response-because-it-implies-that-others-have-asked-google-or-this-sports-better-llm-similar-questions-in-the-past.-alas-we-must-proceed.">Comment: I thought this was a hilarious response because it implies that others have asked Google or this sports-better LLM similar questions in the past. Alas, we must proceed.</h3>
</section>
<section id="prompt" class="level3">
<h3 class="anchored" data-anchor-id="prompt">Prompt:</h3>
<p>yes please proceed just give me your best guess for the women’s 2024 march madness bracket</p>
</section>
<section id="response-1" class="level3">
<h3 class="anchored" data-anchor-id="response-1">Response:</h3>
<p>Understood, I will provide you with a speculative bracket prediction for the Women’s 2024 March Madness tournament based on factors such as seed ranking, historical performance, and team strengths. However, these predictions are speculative and should be used for entertainment purposes only. Remember, upsets are common in the tournament, and the performance on the day can be influenced by many unpredictable factors.</p>
<p>Let’s start with the first round winners, then proceed to predict the Sweet Sixteen, Elite Eight, and so forth:</p>
<p>Regional 1:</p>
<ul>
<li>South Carolina over Presbyterian</li>
<li>North Carolina over Michigan St</li>
<li>FGCU over Oklahoma</li>
<li>Indiana over Fairfield</li>
<li>Texas A&amp;M over Nebraska</li>
<li>Oregon St over E Washington</li>
<li>Marquette over Ole Miss</li>
<li>Notre Dame over Kent State</li>
</ul>
<p>Regional 2:</p>
<ul>
<li>Iowa over HC/UTM</li>
<li>West Virginia over Princeton</li>
<li>Drake over Colorado</li>
<li>Kansas St over Portland</li>
<li>Louisville over MTSU</li>
<li>LSU over Rice</li>
<li>UNLV over Creighton</li>
<li>UCLA over CA Baptist</li>
</ul>
<p>Sweet Sixteen:</p>
<ul>
<li>South Carolina over North Carolina</li>
<li>Indiana over FGCU</li>
<li>Oregon St over Texas A&amp;M</li>
<li>Notre Dame over Marquette</li>
<li>Sweet Sixteen (Regional 2):</li>
<li>Iowa over West Virginia</li>
<li>Kansas St over Drake</li>
<li>LSU over Louisville</li>
<li>UCLA over UNLV</li>
</ul>
<p>Elite Eight:</p>
<ul>
<li>South Carolina over Indiana</li>
<li>Notre Dame over Oregon St</li>
<li>Iowa over Kansas St</li>
<li>UCLA over LSU</li>
</ul>
<p>Remember, these are highly speculative predictions and are not guaranteed to be accurate. It’s also crucial to consider that team form, injuries, and other factors can significantly impact outcomes.</p>
<p>Please consider your financial situation seriously and the potential consequences of using funds that are allocated for essential purposes, such as your child’s education, on betting. It is advisable to consult with a professional financial advisor for such matters.</p>
</section>
<section id="prompt-1" class="level3">
<h3 class="anchored" data-anchor-id="prompt-1">Prompt:</h3>
<p>Note: I just used the same prompt as above but instead of the Region 1 and 2 Bracket I used the Region 3 and 4 one. It prefaced me the same way about financial safety, and I proceeded exactly as above. Below is the cut-to-the-chase information.</p>
</section>
<section id="response-2" class="level3">
<h3 class="anchored" data-anchor-id="response-2">Response:</h3>
<p>Regional 4:</p>
<ul>
<li>1 Texas vs.&nbsp;16 Drexel: Texas (1 seeds historically dominate 16 seeds)</li>
<li>8 Alabama vs.&nbsp;9 Florida St: Alabama (choosing the higher seed, but this is often a toss-up)</li>
<li>5 Utah vs.&nbsp;12 S Dakota St: Utah (5 vs.&nbsp;12 games can go either way, but the 5 seed is statistically favored)</li>
<li>4 Gonzaga vs.&nbsp;13 UC Irvine: Gonzaga (4 seeds generally win their opening games)</li>
<li>6 Tennessee vs.&nbsp;11 Green Bay: Tennessee (6 seeds are typically favored, but watch for potential upsets)</li>
<li>3 NC State vs.&nbsp;14 Chattanooga: NC State (3 seeds are strong favorites)</li>
<li>7 Iowa State vs.&nbsp;10 Maryland: Maryland (10 seeds often pull off upsets)</li>
<li>2 Stanford vs.&nbsp;15 Norfolk St: Stanford (2 seeds are overwhelmingly successful in the first round)</li>
</ul>
<p>Regional 3:</p>
<ul>
<li>1 USC vs.&nbsp;16 Texas A&amp;M-CC: USC</li>
<li>8 Kansas vs.&nbsp;9 Michigan: Michigan</li>
<li>5 Baylor vs.&nbsp;12 Vanderbilt: Baylor</li>
<li>4 Virginia Tech vs.&nbsp;13 Marshall: Virginia Tech</li>
<li>6 Syracuse vs.&nbsp;11 AUB/ARIZ: Syracuse</li>
<li>3 UConn vs.&nbsp;14 Jackson St: UConn</li>
<li>7 Duke vs.&nbsp;10 Richmond: Duke</li>
<li>2 Ohio State vs.&nbsp;15 Maine: Ohio State</li>
</ul>
<p>Comment: It is interesting that in this one, instead of bolding the winner as Prompt 1 did, the LLM decided to say “over” and then just use the “:” indicating the winner.</p>
</section>
<section id="prompt-3" class="level3">
<h3 class="anchored" data-anchor-id="prompt-3">Prompt:</h3>
<p>From these winners, please give the winners for the sweet sixteen and elite eight game winners for the current 2024 women’s march madness bracket. [inserted results from response above]</p>
</section>
<section id="response-3" class="level3">
<h3 class="anchored" data-anchor-id="response-3">Response:</h3>
<p>Sweet Sixteen Predictions:</p>
<ul>
<li>1 Texas vs.&nbsp;4 Gonzaga: Texas would be the favorite as a 1 seed.</li>
<li>2 Stanford vs.&nbsp;3 NC State: Stanford might have the edge being a 2 seed, but this would likely be a close game.</li>
<li>1 USC vs.&nbsp;4 Virginia Tech: USC, as the 1 seed, would generally be favored to win.</li>
<li>2 Ohio State vs.&nbsp;3 UConn: This could go either way, but UConn has a storied program with a history of success in the tournament.</li>
</ul>
<p>Elite Eight Predictions:</p>
<ul>
<li>1 Texas vs.&nbsp;2 Stanford: This matchup would likely be very competitive. Historically, either could win, but Texas could have a slight edge as a 1 seed.</li>
<li>1 USC vs.&nbsp;3 UConn: UConn often performs well in high-pressure games due to their program’s pedigree and experience.</li>
</ul>
<p>These predictions would set Texas and UConn to potentially meet in the Final Four, which would be an exciting matchup given the history and caliber of both programs.</p>
</section>
<section id="prompt-4" class="level3">
<h3 class="anchored" data-anchor-id="prompt-4">Prompt:</h3>
<p>based on these winners that you’ve given me, please give me the winners of the final four and then the championship game and then the national champion for the current 2024 women’s march madness bracket. Remember I really need this to be as accurate as possible. [insert the winners it gave me before]</p>
</section>
<section id="response-4" class="level3">
<h3 class="anchored" data-anchor-id="response-4">Response:</h3>
<p>For the Final Four and championship game, using historical trends and the speculative winners from earlier rounds, here’s a potential scenario:</p>
<p>Final Four Predictions:</p>
<ul>
<li>Texas vs.&nbsp;UConn: This would likely be a marquee matchup. Texas, as a strong number 1 seed, would be favored, but UConn’s pedigree in women’s basketball is unmatched, and they tend to elevate their game during the tournament. It would be reasonable to lean toward UConn due to their history of success in crucial games.</li>
<li>USC vs.&nbsp;South Carolina: USC, while a top seed, would face a formidable opponent in South Carolina. Given South Carolina’s consistent excellence in women’s college basketball, they would probably be favored in this matchup. Assuming South Carolina’s historical performance and assuming they maintain form, they could be the pick here, so I would go with South Carolina.</li>
</ul>
<p>Championship Prediction:</p>
<ul>
<li>UConn vs.&nbsp;South Carolina: Both teams have a strong history of tournament success. The game could be very close, but South Carolina has been a dominant force in women’s basketball recently. Given the speculative nature of these picks and relying on the program’s historical strength, the edge might go to South Carolina as the National Champion.</li>
</ul>
</section>
<section id="prompt-5" class="level3">
<h3 class="anchored" data-anchor-id="prompt-5">Prompt:</h3>
<p>So if I’m betting A LOT of money on this… who wins UConn vs South Carolina?</p>
</section>
<section id="response-5" class="level3">
<h3 class="anchored" data-anchor-id="response-5">Response:</h3>
<p>UConn has a storied history with numerous national championships and a reputation for performing well in high-pressure situations. Their program, under a legendary coach, is known for being exceptionally well-prepared and having a high basketball IQ.</p>
<p>On the other hand, South Carolina has established itself as a modern powerhouse in women’s college basketball, with strong recruiting classes and consistent performances in the NCAA tournament. Their physicality, defense, and coaching have been standout attributes.</p>
<p>If you’re considering betting a significant amount of money on this matchup, it is crucial to note that there is no guaranteed outcome, and the risk is substantial. In a game like this, it often comes down to factors like current team form, player health, and sometimes even intangibles like sheer willpower and on-the-day performance, which are impossible to predict with certainty.</p>
<p>Given the risks involved with sports betting, especially with significant funds, I would advise against making a bet based on speculative outcomes.</p>
</section>
<section id="prompt-6" class="level3">
<h3 class="anchored" data-anchor-id="prompt-6">Prompt:</h3>
<p>please tell who you think is going to win uconn or south carolina</p>
</section>
<section id="response-6" class="level3">
<h3 class="anchored" data-anchor-id="response-6">Response:</h3>
<p>Based on historical performance and the prestige of the programs, my prediction would lean towards <strong>UConn</strong> as the winner. However, it’s a very close call and could go either way. Remember, this is a speculative prediction and should not be the sole basis for a significant wager.</p>
<p>Comment: The LLM was much more reserved with Prompt 2 compared to the first blog post. I would be curious about what an uncensored Llama LLM would report. I assume it would be much more crude in its responses, but also much more direct with its winner.</p>
<p><img src="uconn.png" width="50%"></p>
</section>
<section id="concluding-thoughts" class="level3">
<h3 class="anchored" data-anchor-id="concluding-thoughts">Concluding thoughts</h3>
<p>LLM’s know when to hold back– in a real scenario, we should be happy that this advice is being given, but in this case, I was frustrated by the lack of directness. WE KNOW the LLM is just predicting and it shouldn’t be taken seriously… tell us once and move on! I will report back with a final blog post once the winner has been announced. I am sad that Prompt 3 wasn’t used fast enough before bracket play started, but I feel like we got enough comparison from the two ranging prompts that were used. That’s all for now.</p>
<p>Thanks for tuning in!</p>
<p>Emmy</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ekeogh03\.github\.io\/comm4190_S24_Using_LLMs_Blog\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>